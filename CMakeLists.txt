cmake_minimum_required(VERSION 3.16)

project(TEM_Acquisition VERSION 0.1 LANGUAGES CXX)

set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_CXX_STANDARD 17)

find_package(Qt6 6.5 REQUIRED COMPONENTS Quick Gui Qml Sql Network Widgets Charts)

# Enable automatic processing of Qt macro instructions
set(CMAKE_AUTOMOC ON)
set(CMAKE_AUTORCC ON)
set(CMAKE_AUTOUIC ON)

# Source files
qt_add_executable(TEM_Acquisition
    main.cpp
    Backend.h
    Backend.cpp
    DatabaseManager.h
    DatabaseManager.cpp
    TcpClient.h
    TcpClient.cpp
    PlaybackBackend.h
    PlaybackBackend.cpp
)

# QML files via QRC resource
qt_add_resources(TEM_Acquisition "qml"
    PREFIX "/"
    FILES
        "BSContent/App.qml"
        "BSContent/Screen01.ui.qml"
        "BSContent/PlaybackWindow.qml"
        "BSContent/MockBackend.qml"
        "qtquickcontrols2.conf"
)

# Note: Qt Design Studio projects usually have complex resource trees (qmldir, fonts, imported modules).
# Since BSContent/ is generated by Design Studio, we glob all files and dump them to resources.
file(GLOB_RECURSE QML_FILES RELATIVE ${CMAKE_CURRENT_SOURCE_DIR}
    "BS/*.qml"
    "BS/qmldir"
    "BSContent/fonts/*"
)

qt_add_resources(TEM_Acquisition "designer_files"
    PREFIX "/"
    FILES ${QML_FILES}
)

target_link_libraries(TEM_Acquisition
    PRIVATE Qt6::Quick Qt6::Gui Qt6::Qml Qt6::Sql Qt6::Network Qt6::Widgets Qt6::Charts
)
